var $=jQuery,config={apiKey:"AIzaSyB3Lhvild3G8GO0jCrdOxG8TlQA1LHFUME",authDomain:"shawn-10ed4.firebaseapp.com",databaseURL:"https://shawn-10ed4.firebaseio.com",projectId:"shawn-10ed4",storageBucket:"shawn-10ed4.appspot.com",messagingSenderId:"1032261355599"};firebase.initializeApp(config);var uid,db=firebase.database();firebase.auth().onAuthStateChanged(function(a){if(a){a.isAnonymous;uid=a.uid,console.log(uid)}else firebase.auth().signInAnonymously().catch(function(a){var b=a.code,c=a.message;alert("Please update your settings.")})});var questionNumber,sectionRef=db.ref("activeSection");sectionRef.on("value",function(a){questionNumber=a.val();var b="#section_"+questionNumber;showSection(b)});function showSection(a){$("#page_home").find(a).slideDown().siblings("section").slideUp(),$("#section_questions .row").eq(questionNumber).addClass("active").siblings(".row").removeClass("active")}var leaving=!1;function closeWorld(){$("#page_home").length||$("#page_world").length&&(leaving=!0,db.ref("worldOpen").set(!1),worldOpen=!1)}window.onbeforeunload=closeWorld,$(document).ready(function(){function a(a,b){var c=Date.now();db.ref("answers/"+a+"/"+c).set({new:!0,text:b})}function b(a){$(a).find("form").submit()}var c;setInterval(function(){$("#page_home").length||($("#page_world").length&&!leaving?(db.ref("worldOpen").set(!0),c=!0):(db.ref("worldOpen").set(!1),c=!1))}),$("#page_world").length&&$("#section_questions .row").on("click",function(){var a=$(this).data("choice");db.ref("activeSection").set(a)});var d=!0;if($("body").on("submit","form",function(b){b.preventDefault();var c=$(this).find(".user-answer"),e=c.val()||null;null!==e&&(a(questionNumber,e),$("#page_home #section_"+questionNumber+" .answer-box").addClass("answered")),setTimeout(function(){c.val("")},1e3),setTimeout(function(){d=!0},1e3)}),$("#section_1").length){var e=document.getElementById("section_1"),f=new Hammer(e);f.on("pan",function(){d&&1===questionNumber&&(console.log(1),d=!1,b("#section_1"))})}if($("#section_2").length){var e=document.getElementById("section_2"),f=new Hammer(e);f.on("pan",function(){d&&2===questionNumber&&(console.log(2),d=!1,b("#section_2"))})}if($("#section_3").length){var e=document.getElementById("section_3"),f=new Hammer(e);f.on("pan",function(){d&&3===questionNumber&&(console.log(3),d=!1,b("#section_3"))})}if($("#page_world").length){db.ref("answers").once("value",function(a){var b=a.val();$.each(b,function(a,b){var c=a,d=b;void 0!=d&&null!=b&&$.each(d,function(a){db.ref("answers/"+c+"/"+a+"/new").set(!1)})})});var g=db.ref("answers/1");g.on("value",function(a){var b=a.val(),c=$("#world_answers_1");c.html(""),$.each(b,function(a,b){var d;d=b.new?"<li class=\"new-answer\"><p>"+b.text+"</p></li>":"<li><p>"+b.text+"</p></li>",c.prepend(d)})});var h=db.ref("answers/2");h.on("value",function(a){var b=a.val(),c=$("#world_answers_2");c.html(""),$.each(b,function(a,b){var d;d=b.new?"<li class=\"new-answer\"><p>"+b.text+"</p></li>":"<li><p>"+b.text+"</p></li>",c.prepend(d)})});var i=db.ref("answers/3");i.on("value",function(a){var b=a.val(),c=$("#world_answers_3");c.html(""),$.each(b,function(a,b){var d;d=b.new?"<li class=\"new-answer\"><p>"+b.text+"</p></li>":"<li><p>"+b.text+"</p></li>",c.prepend(d)})})}});